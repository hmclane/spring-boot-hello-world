---
name: Qubeship Out of the box opinion
description: out-of-box opinion
visibility: public
graml:
  version: 1.0
graph:
  build:
    has:
      - compile
      - unittest
      - code_coverage
      - static_code_analysis
      - push_to_artifactory
    on_error:
      - notify
    next: bake
  bake:
    has
      - docker_build
      - harden
      - push_to_registry
    on_error:
      - notify
    next: deploy_to_qa
  deploy_to_qa:
    has:
      - release
      - functional_test
      - manual_approve
      - publish
    on_error:
      - notify
    next: deploy_to_prod
  deploy_to_prod:
    has:
      - release
      - notify
    on_error:
      - notify
# below is the default implementation
vertices:
  docker_build:
    action:
      - docker build
      - echo
  push_to_registry:
    action: docker push
